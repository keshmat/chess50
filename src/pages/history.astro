---
// src/pages/history.astro
import { Image, Picture } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const images = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/archive/*.jpg'
);

const imageFiles = await Promise.all(
  Object.entries(images).map(async ([src, importer]) => {
    const { default: image } = await importer();
    const fileName = src.split('/').pop()?.replace(/ 001\.jpg$/, '') || '';
    return {
      src: image,
      alt: fileName.replace(/_/g, ' ')
    };
  })
);
---
<Layout title="History of Lebanese Chess">
  <Header />
  <main class="container mx-auto p-8">
    <section id="history-gallery" class="text-center">
      <h1 class="text-4xl font-bold mb-4">A Pictorial History of Lebanese Chess</h1>
      <p class="text-lg mb-8 max-w-3xl mx-auto">
        These images, scanned from newspaper clippings and personal collections, offer a glimpse into the rich history of chess in Lebanon. They feature past champions, pivotal tournaments, and moments that have shaped the national chess scene. This collection is a tribute to the players and organizers who have contributed to the legacy of Lebanese chess over the past 50 years.
      </p>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {imageFiles.map((image, index) => (
          <div class="card card-compact bg-base-100 shadow-xl overflow-hidden group">
            <figure 
              class="aspect-square relative cursor-pointer"
              onclick={`modal_${index}.showModal()`}
            >
              <Image 
                src={image.src} 
                alt={image.alt} 
                widths={[400, 800]}
                sizes="(max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw"
                class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-110" 
              />
              <div class="absolute inset-0 bg-transparent group-hover:bg-black/40 transition-all duration-300 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" height="48" width="48" fill="white" viewBox="0 0 32 32" class="opacity-0 group-hover:opacity-75 transition-opacity">
                  <path d=" M16 4 L28 4 L28 16 L24 12 L20 16 L16 12 L20 8z M4 16 L8 20 L12 16 L16 20 L12 24 L16 28 L4 28z "/>
                </svg>
              </div>
            </figure>
            <dialog id={`modal_${index}`} class="modal">
              <div class="modal-box w-11/12 max-w-5xl">
                <Picture 
                  src={image.src} 
                  alt={image.alt} 
                  widths={[800, 1200, 2000]}
                  sizes="(min-width: 1280px) 2000px, 100vw"
                  class="w-full" 
                />
                <h3 class="font-bold text-lg mt-4">{image.alt}</h3>
                <div class="modal-action">
                  <form method="dialog">
                    <button class="btn">Close</button>
                  </form>
                </div>
              </div>
            </dialog>
          </div>
        ))}
      </div>
      <p class="mt-12 text-lg">
        This is just a small selection of our collection. We invite you to visit Keshmat Chess Center to see more historical scans, artifacts, and books from the history of Lebanese chess.
      </p>
    </section>
  </main>
  <Footer />
</Layout> 